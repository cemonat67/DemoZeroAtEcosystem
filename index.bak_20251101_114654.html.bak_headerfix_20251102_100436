<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="0; url=RabateksDPP.html">
    <title>Redirecting to Rabhateks DPP Dashboard</title>

<!-- ICON LIBRARIES -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css">
<!-- END ICON LIBRARIES -->

<style id="zplogo-style">
  .zplogo-wrap{position:absolute;left:24px;top:12px;z-index:10;pointer-events:none}
  .zplogo-wrap img{height:84px;width:auto;display:block}
  @media (max-width:768px){ .zplogo-wrap img{height:64px} }
</style>
</head>
<body>
<div class="zplogo-wrap"><img src="assets/img/zaplogo.svg" alt="Zero@Production"></div>

<p>If you are not redirected automatically, <a href="RabateksDPP.html">click here</a>.</p>
<script>
// Push Orders functionality
function pushOrders() {
  try {
    // Check if RandomOrderCreator data exists in localStorage
    const ordersData = localStorage.getItem('randomOrdersDatabase');
    
    if (!ordersData) {
      alert('No orders found! Please generate orders in RandomOrderCreator first.');
      window.open('RandomOrderCreator.html', '_blank');
      return;
    }
    
    const orders = JSON.parse(ordersData);
    
    if (orders.length === 0) {
      alert('No orders to export! Please generate orders in RandomOrderCreator first.');
      window.open('RandomOrderCreator.html', '_blank');
      return;
    }
    
    // Export orders as CSV
    exportOrdersToCSV(orders);
    
    // Show success message
    alert(`Successfully exported ${orders.length} orders!`);
    
  } catch (error) {
    console.error('Error pushing orders:', error);
    alert('Error exporting orders. Please try again.');
  }
}

// Function to export orders to CSV
function exportOrdersToCSV(orders) {
  const headers = [
    'ID', 'Country', 'Facility', 'PO Number', 'Style Name', 'Product Type',
    'Fabric Type', 'Fabric Name', 'Fabric Construction', 'Fabric Weight (gsm)',
    'Quantity', 'Created Date'
  ];
  
  const csvContent = [
    headers.join(','),
    ...orders.map(order => [
      order.id || '',
      `"${order.country || ''}"`,
      `"${order.facility || ''}"`,
      `"${order.poNumber || ''}"`,
      `"${order.styleName || ''}"`,
      `"${order.productType || ''}"`,
      `"${order.fabricType || ''}"`,
      `"${order.fabricName || ''}"`,
      `"${order.fabricConstruction || ''}"`,
      order.fabricWeight || '',
      order.quantity || '',
      `"${order.createdDate || ''}"`
    ].join(','))
  ].join('\n');
  
  // Create and download CSV file
  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
  const link = document.createElement('a');
  const url = URL.createObjectURL(blob);
  link.setAttribute('href', url);
  link.setAttribute('download', `exported_orders_${new Date().toISOString().split('T')[0]}.csv`);
  link.style.visibility = 'hidden';
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
</script>
</body>
</html>
<!-- Find and replace the existing GarmentDPP button section -->
<div class="button-group" style="display: flex; gap: 12px; align-items: center; margin: 20px 0;">
  <!-- NEW: Push Orders Button (on the left) -->
  <button class="btn" id="pushOrdersBtn" onclick="pushOrders()" style="background: #f9ba00; color: #02154e; border: 1px solid #f9ba00; padding: 12px 20px; border-radius: 8px; font-weight: 600; cursor: pointer;">
    ðŸ“¤ Push Orders
  </button>
  
  <!-- Existing GarmentDPP Button -->
  <a href="GarmentDPP.html" class="btn primary" style="background: #02154e; color: white; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: 600;">
    ðŸš€ Open Garment DPP
  </a>
</div>